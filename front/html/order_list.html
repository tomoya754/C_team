<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>æ³¨æ–‡æ›¸ä¸€è¦§</title>
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/order_list.css">
</head>
<body>
    <!-- ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ -->
    <div class="menu-btn" id="menuBtn">&#9776;</div>
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼èƒŒæ™¯ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ï¼‰ -->
    <div class="sidebar-bg" id="sidebarBg"></div>
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <nav class="sidebar" id="sidebar">
        <span class="sidebar-close" id="sidebarClose">&times;</span>
        <ul>
            <li><a href="/html/home.html">ãƒ»<u>HOME</u></a></li>
            <li><a href="/html/order_list.html">ãƒ»æ³¨æ–‡æ›¸ä¸€è¦§</a></li>
            <li><a href="/html/delivery_list.html">ãƒ»ç´å“æ›¸ä¸€è¦§</a></li>
            <li><a href="/html/statistics_list.html">ãƒ»çµ±è¨ˆæƒ…å ±ä¸€è¦§</a></li>
            <li><a href="/html/customer_register.html">ãƒ»é¡§å®¢æƒ…å ±ç™»éŒ²</a></li>
        </ul>
    </nav>
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="main" id="main">
        <h1 class="orders-title">æ³¨æ–‡æ›¸ä¸€è¦§</h1>
        <div class="search-toolbar">
            <div class="search-area">
                <span class="search-icon">ğŸ”</span>
                <input type="text" class="search-input" placeholder="æ³¨æ–‡æ›¸No.ã€æ³¨æ–‡å†…å®¹">
                <button class="filter-btn"><span class="filter-icon">â·</span></button>
            </div>
        </div>
        <div class="orders-table-area">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th style="width:32px;"></th>
                        <th style="width:90px;">æ³¨æ–‡æ›¸No.</th>
                        <th style="width:110px;">é¡§å®¢ID</th>
                        <th style="width:160px;">é¡§å®¢å</th>
                        <th style="width:180px;">æ³¨æ–‡å†…å®¹</th>
                        <th style="width:120px;">é›»è©±ç•ªå·</th>
                        <th style="width:100px;">æ³¨æ–‡æ—¥</th>
                        <th style="width:100px;">ç´å“äºˆå®š</th>
                        <th style="width:80px;">å‚™è€ƒ</th>
                    </tr>
                </thead>
                <tbody id="orders-tbody">
                    <!-- ã“ã“ã«JSã§æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ -->
                </tbody>
            </table>
        </div>
        <div class="orders-btns-row">
            <a href="order_form.html" class="btn create">æ–°è¦æ³¨æ–‡æ›¸ä½œæˆ</a>
            <button class="btn delete-btn">æ³¨æ–‡æ›¸å‰Šé™¤</button>
        </div>
        <script>
        // ã‚µã‚¤ãƒ‰ãƒãƒ¼é–‹é–‰
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        const sidebarBg = document.getElementById('sidebarBg');
        const sidebarClose = document.getElementById('sidebarClose');
        function openSidebar() {
            sidebar.classList.add('open');
            sidebarBg.classList.add('show');
        }
        function closeSidebar() {
            sidebar.classList.remove('open');
            sidebarBg.classList.remove('show');
        }
        menuBtn.onclick = openSidebar;
        sidebarClose.onclick = closeSidebar;
        sidebarBg.onclick = closeSidebar;

        // æ³¨æ–‡æ›¸ä¸€è¦§ã‚’APIã‹ã‚‰å–å¾—ã—ã¦è¡¨ç¤º
        fetch('http://localhost:3000/api/orders')
            .then(res => res.json())
            .then(data => {
                const tbody = document.getElementById('orders-tbody');
                tbody.innerHTML = '';
                data.forEach(order => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td><input type="checkbox"></td>
                        <td>${order.orderId}</td>
                        <td>${order.customerId}</td>
                        <td>${order.customerName}</td>
                        <td>${order.orderDetail}</td>
                        <td>${order.phone}</td>
                        <td>${order.orderDate}</td>
                        <td>-</td>
                        <td>${order.note || ''}</td>
                    `;
                    tbody.appendChild(tr);
                });
            })
            .catch(err => {
                console.error('æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', err);
            });

        // ä¿å­˜ãƒœã‚¿ãƒ³ã§APIã«æ³¨æ–‡æ›¸ã‚’ç™»éŒ²
        document.getElementById('saveBtn').onclick = async function() {
            // ...å…¥åŠ›å€¤ã®å–å¾—...
            // ...ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³...
            const res = await fetch('http://localhost:3000/api/orders', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    customerId,
                    customerName,
                    orderDetail,
                    orderDate,
                    phone,
                    note
                })
            });
            if (res.ok) {
                alert('æ³¨æ–‡æ›¸ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
                location.href = 'order_list.html'; // ä¸€è¦§ã¸é·ç§»
            } else {
                const err = await res.json();
                alert('ã‚¨ãƒ©ãƒ¼: ' + err.error);
            }
        };
        </script>
    </div>
</body>
</html>